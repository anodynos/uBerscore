<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>test: uberscore & spec: 'UMDplain', loader: 'AMD/RequireJS' }</title>
  </head>

  <body>

    <h1>uberscore/spec - template: 'UMDplain'/'UMD', loader: 'AMD/RequireJS' }</h1>

    <h1> `uberscore.js` </h1>
    <h2> template: 'UMDplain' </h2>

    <h1> `spec` </h1>

    <h2> template: 'UMD' </h2>

    <h3> Loader: "AMD/RequireJS"</h3>

    <strong> ** uRequire note: **</strong>
    <ul>
      <li>Dependencies (eg. `lodash`) are loaded through RequireJs loader (using `rjs.paths`)
      <li>'uberscore' dependency is loading through `rjs.baseUrl`, which in turn loads all bundle dependencies *as seperate files*).
    </ul>

    <link rel="stylesheet" href="../../bower_components/mocha/mocha.css" />
    <div id="mocha"></div>
  </body>

  <!-- grunt-mocha requires mocha (& chai) as plain <script> -->
  <script src="../../bower_components/mocha/mocha.js"></script>
  <script src="../../bower_components/chai/chai.js"></script>

  <script src="../../bower_components/requirejs/require.js"></script>

  <script type="text/javascript">
     window._B = "Old global `_B`" ;
     window.uberscore = "Old global `uberscore`";

     require.config ({
      // set baseUrl to point to the 'bundle', relative to this HTML
      baseUrl: '../../build/UMD', // needed only if loading as individual AMD/UMD (without optimization)
//      baseUrl: '../../build/AMD',
//      baseUrl: '../../build/AMDunderscore',
//      baseUrl: '../../build/UMDunderscore',
//      baseUrl: '../../build/UMDplainReplaceDep',

      // all libraries are now relative to the bundle/baseUrl
      paths: {
        chai:  "../../bower_components/chai/chai",
        mocha: "../../bower_components/mocha/mocha",

        lodash: "../../bower_components/lodash/dist/lodash.min",
        underscore: "../../bower_components/underscore/underscore-min", // drop in 'alternative' of lodash

        // ** uRequire note: **
        // if the following 'rjs.paths.uberscore' exists,
        //  it mandates we are loading the OPTIMIZED version,
        // else
        //  we load 'uberscore' dependency (and its contained deps) through `rjs.baseUrl`.
        // this is the only change needed!
        //uberscore : "../../build/uberscore-dev",
        spec: "../spec/"
      },

      shim: {
        mocha: { deps: [], exports: "mocha"},
        lodash: { deps: [], exports: "_"}, // needed only when 'lodash' is 'underscore'
        underscore: { deps: [], exports: "_"} // needed only when 'lodash' is 'underscore'
      }
    });

    // initialize mocha
    mocha.setup('bdd');

    // load unit-tests here, always relative to the bundle/baseUrl
    require(["spec/index" ], function(){
      if (window.mochaPhantomJS) {
        mochaPhantomJS.run();
      } else {
        mocha.run().globals(['_', '_B', 'uberscore']);
      }
    });

  </script>
</html>